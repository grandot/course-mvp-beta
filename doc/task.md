# Claude Code ä»»å‹™åŸ·è¡Œè¦åŠƒè¡¨

æœ¬æ–‡ä»¶å®šç¾©äº†å„ç¨®é–‹ç™¼ä»»å‹™çš„æ¨™æº–åŸ·è¡Œæµç¨‹ï¼Œç¢ºä¿ Claude Code èƒ½å¤ ç³»çµ±æ€§åœ°å®Œæˆä»»å‹™ã€‚

## ğŸ“‹ ä»»å‹™åˆ†é¡

### A. åŠŸèƒ½é–‹ç™¼ä»»å‹™
- æ–°å¢æ„åœ– (Intent)
- æ–°å¢ä»»å‹™è™•ç†å™¨ (Task Handler)
- æ•´åˆå¤–éƒ¨ API
- è³‡æ–™æ¨¡å‹èª¿æ•´

### B. ç¶­è­·å„ªåŒ–ä»»å‹™
- ç¨‹å¼ç¢¼é‡æ§‹
- æ•ˆèƒ½å„ªåŒ–
- éŒ¯èª¤ä¿®å¾©
- æ–‡ä»¶æ›´æ–°

### C. é…ç½®ç®¡ç†ä»»å‹™
- ç’°å¢ƒè®Šæ•¸è¨­å®š
- éƒ¨ç½²é…ç½®
- Feature Flag èª¿æ•´

---

## ğŸ¯ A. åŠŸèƒ½é–‹ç™¼ä»»å‹™

### A1. æ–°å¢æ„åœ– (Add New Intent)

**ä»»å‹™ç›®æ¨™**ï¼šæ–°å¢ä¸€å€‹æ–°çš„å°è©±æ„åœ–ï¼Œè®“æ©Ÿå™¨äººèƒ½ç†è§£æ–°çš„ä½¿ç”¨è€…éœ€æ±‚ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **åˆ†æéœ€æ±‚**
   - [ ] é–±è®€ `/doc/implement.md` ç¢ºèªæ¥­å‹™é‚è¼¯
   - [ ] ç¢ºèªæ„åœ–åç¨±ç¬¦åˆ snake_case è¦ç¯„ï¼ˆå‹•è©_åè©ï¼‰
   - [ ] åˆ—å‡ºå¿…è¦çš„ slotsï¼ˆå¯¦é«”æ¬„ä½ï¼‰

2. **æ›´æ–°é…ç½®**
   - [ ] ç·¨è¼¯ `/config/mvp/intent-rules.yaml`
   - [ ] æ–°å¢æ„åœ–è¦å‰‡ï¼škeywordsã€required_slotsã€priority
   - [ ] è€ƒæ…®æ’é™¤è©é¿å…èª¤åˆ¤

3. **å¯¦ä½œä»»å‹™è™•ç†å™¨**
   - [ ] åœ¨ `/src/tasks/` å»ºç«‹ `handle_[intent]_task.js`
   - [ ] å¯¦ä½œæ¥­å‹™é‚è¼¯
   - [ ] ç¢ºä¿å›å‚³æ ¼å¼ç‚º `{ success: boolean, message: string }`

4. **æ•´åˆæ¸¬è©¦**
   - [ ] ä½¿ç”¨ `node tools/send-test-message.js` æ¸¬è©¦
   - [ ] é©—è­‰æ„åœ–è­˜åˆ¥æ­£ç¢º
   - [ ] é©—è­‰ slots æå–å®Œæ•´
   - [ ] ç¢ºèªå›æ‡‰è¨Šæ¯ç¬¦åˆé æœŸ

5. **æ–‡ä»¶æ›´æ–°**
   - [ ] æ›´æ–° `/doc/developer-guide.md` çš„ä»»å‹™å‡½å¼åˆ—è¡¨
   - [ ] åœ¨ `/doc/implement.md` æ–°å¢å°è©±ç¯„ä¾‹

**ç¯„ä¾‹æŒ‡ä»¤**ï¼š
```bash
# æ¸¬è©¦æ–°æ„åœ–
node tools/send-test-message.js "è«‹å¹«æˆ‘æŸ¥è©¢å°æ˜é€™é€±çš„ä¸Šèª²è¨˜éŒ„"
```

### A2. æ–°å¢ä»»å‹™è™•ç†å™¨ (Add Task Handler)

**ä»»å‹™ç›®æ¨™**ï¼šç‚ºå·²å­˜åœ¨çš„æ„åœ–å¯¦ä½œå…·é«”çš„æ¥­å‹™é‚è¼¯è™•ç†ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **ç†è§£éœ€æ±‚**
   - [ ] æŸ¥çœ‹æ„åœ–çš„ required_slots
   - [ ] ç¢ºèªéœ€è¦å‘¼å«å“ªäº›æœå‹™ï¼ˆGoogle Calendar/Firebaseï¼‰
   - [ ] è¦åŠƒéŒ¯èª¤è™•ç†ç­–ç•¥

2. **å»ºç«‹æª”æ¡ˆ**
   ```javascript
   // /src/tasks/handle_[intent]_task.js
   const { googleCalendarService, firebaseService } = require('../services');
   
   async function handle_[intent]_task(slots, userId) {
     try {
       // 1. é©—è­‰è¼¸å…¥
       // 2. åŸ·è¡Œæ¥­å‹™é‚è¼¯
       // 3. å›å‚³çµæœ
       return { success: true, message: 'âœ… æˆåŠŸè¨Šæ¯' };
     } catch (error) {
       console.error('Error in handle_[intent]_task:', error);
       return { success: false, message: 'âŒ éŒ¯èª¤è¨Šæ¯' };
     }
   }
   
   module.exports = handle_[intent]_task;
   ```

3. **è¨»å†Šä»»å‹™**
   - [ ] åœ¨ `/src/tasks/index.js` åŒ¯å‡ºæ–°å‡½å¼
   - [ ] åœ¨æ„åœ–è·¯ç”±å™¨ä¸­è¨»å†Šå°æ‡‰é—œä¿‚

4. **å–®å…ƒæ¸¬è©¦**ï¼ˆPhase 2 æ‰éœ€è¦ï¼‰
   - [ ] æ¸¬è©¦æ­£å¸¸æµç¨‹
   - [ ] æ¸¬è©¦éŒ¯èª¤æƒ…æ³
   - [ ] æ¸¬è©¦é‚Šç•Œæ¢ä»¶

### A3. æ•´åˆå¤–éƒ¨ API

**ä»»å‹™ç›®æ¨™**ï¼šæ•´åˆæ–°çš„å¤–éƒ¨æœå‹™ï¼ˆå¦‚åœ–ç‰‡ä¸Šå‚³ã€å¤©æ°£æŸ¥è©¢ç­‰ï¼‰ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **API ç ”ç©¶**
   - [ ] é–±è®€ API æ–‡ä»¶
   - [ ] ç¢ºèªèªè­‰æ–¹å¼
   - [ ] äº†è§£ rate limit å’Œé…é¡é™åˆ¶
   - [ ] æ¸¬è©¦ API endpoint

2. **å»ºç«‹æœå‹™æ¨¡çµ„**
   - [ ] åœ¨ `/src/services/` å»ºç«‹æ–°æœå‹™æª”æ¡ˆ
   - [ ] å¯¦ä½œ API å‘¼å«å°è£
   - [ ] åŠ å…¥éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶
   - [ ] å¯¦ä½œå›æ‡‰è³‡æ–™è½‰æ›

3. **ç’°å¢ƒé…ç½®**
   - [ ] æ–°å¢å¿…è¦çš„ç’°å¢ƒè®Šæ•¸ï¼ˆAPI key ç­‰ï¼‰
   - [ ] æ›´æ–° `.env.example`
   - [ ] åœ¨ README èªªæ˜é…ç½®æ–¹å¼

4. **æ•´åˆåˆ°ä»»å‹™æµç¨‹**
   - [ ] åœ¨ç›¸é—œ task handler ä¸­ä½¿ç”¨æ–°æœå‹™
   - [ ] è™•ç† API éŒ¯èª¤æƒ…æ³
   - [ ] ç¢ºä¿ä½¿ç”¨è€…é«”é©—æµæš¢

### A4. è³‡æ–™æ¨¡å‹èª¿æ•´

**ä»»å‹™ç›®æ¨™**ï¼šä¿®æ”¹ Firebase è³‡æ–™çµæ§‹ä»¥æ”¯æ´æ–°åŠŸèƒ½ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **å½±éŸ¿åˆ†æ**
   - [ ] åˆ—å‡ºå—å½±éŸ¿çš„é›†åˆå’Œæ–‡ä»¶
   - [ ] è©•ä¼°å°ç¾æœ‰è³‡æ–™çš„å½±éŸ¿
   - [ ] è¦åŠƒè³‡æ–™é·ç§»ç­–ç•¥ï¼ˆå¦‚éœ€è¦ï¼‰

2. **æ›´æ–°è³‡æ–™æ¨¡å‹**
   - [ ] ä¿®æ”¹ `/doc/developer-guide.md` çš„è³‡æ–™çµæ§‹èªªæ˜
   - [ ] æ›´æ–°ç›¸é—œçš„ service å‡½å¼
   - [ ] ç¢ºä¿å‘å¾Œç›¸å®¹ï¼ˆæˆ–æä¾›é·ç§»è…³æœ¬ï¼‰

3. **æ¸¬è©¦é©—è­‰**
   - [ ] æ¸¬è©¦æ–°æ¬„ä½çš„è®€å¯«
   - [ ] é©—è­‰æ—¢æœ‰åŠŸèƒ½ä¸å—å½±éŸ¿
   - [ ] æª¢æŸ¥æŸ¥è©¢æ•ˆèƒ½

### A5. èªæ„è™•ç†ä»»å‹™ï¼ˆIntent + Slot æ¨¡å‹é–‹ç™¼ï¼‰

**ä»»å‹™ç›®æ¨™**ï¼šé–‹ç™¼å’Œèª¿æ•´èªæ„è­˜åˆ¥ç³»çµ±ï¼Œè™•ç†è‡ªç„¶èªè¨€ç†è§£çš„ç›¸é—œä»»å‹™ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **æ–°å¢æ„åœ–è­˜åˆ¥è¦å‰‡**
   - [ ] åœ¨ `/config/mvp/intent-rules.yaml` æ–°å¢æ„åœ–
   - [ ] å®šç¾©é—œéµè©é™£åˆ—ï¼ˆkeywordsï¼‰
   - [ ] è¨­å®šå¿…è¦æ¬„ä½ï¼ˆrequired_slotsï¼‰
   - [ ] é…ç½®å„ªå…ˆç´šï¼ˆpriorityï¼Œæ•¸å­—è¶Šå°å„ªå…ˆç´šè¶Šé«˜ï¼‰
   - [ ] åŠ å…¥æ’é™¤è©ï¼ˆexclude_keywordsï¼‰é¿å…èª¤åˆ¤

2. **è¨­è¨ˆ Slot æŠ½å– Prompt**
   - [ ] åœ¨ `/src/intent/extractSlots.js` åŠ å…¥æ–°çš„æŠ½å–é‚è¼¯
   - [ ] ç‚ºæ¯å€‹ slot å®šç¾©æ¸…æ¥šçš„æ ¼å¼è¦æ±‚
   - [ ] åŠ å…¥ç¯„ä¾‹è¼¸å…¥å’Œé æœŸè¼¸å‡º
   - [ ] è™•ç†æ¨¡ç³Šèªå¥çš„é è¨­å€¼

3. **è¨­è¨ˆ OpenAI API Fallback æ ¼å¼**
   ```javascript
   // OpenAI API å‘¼å«æ ¼å¼ç¯„ä¾‹
   const prompt = `
   åˆ¤æ–·ä»¥ä¸‹èªå¥çš„æ„åœ–ï¼Œå›å‚³ JSON æ ¼å¼ï¼š
   
   èªå¥ï¼šã€Œ${userMessage}ã€
   
   å¯èƒ½çš„æ„åœ–ï¼šadd_course, query_schedule, set_reminder, record_content, cancel_course
   
   å›å‚³æ ¼å¼ï¼š{"intent": "æ„åœ–åç¨±", "confidence": 0.8}
   å¦‚æœä¸ç¢ºå®šï¼Œè«‹å›å‚³ï¼š{"intent": "unknown", "confidence": 0.0}
   `;
   ```

4. **æ¸¬è©¦èªæ„è™•ç†**
   - [ ] ä½¿ç”¨ `node tools/send-test-message.js` æ¸¬è©¦å„ç¨®èªå¥
   - [ ] é©—è­‰æ„åœ–è­˜åˆ¥æº–ç¢ºç‡
   - [ ] æª¢æŸ¥ slots æŠ½å–å®Œæ•´æ€§
   - [ ] æ¸¬è©¦é‚Šç•Œæƒ…æ³ï¼ˆæ¨¡ç³Šèªå¥ã€éŒ¯å­—ã€ç°¡å¯«ï¼‰

5. **Debug èªæ„éŒ¯èª¤**
   - [ ] åŠ å…¥ console.log è¿½è¹¤æ„åœ–è­˜åˆ¥éç¨‹
   - [ ] æª¢æŸ¥ intent-rules.yaml çš„é—œéµè©æ˜¯å¦è¶³å¤ 
   - [ ] é©—è­‰ OpenAI API çš„ prompt æ˜¯å¦æ¸…æ¥š
   - [ ] ç¢ºèª slots çš„è³‡æ–™æ ¼å¼è½‰æ›æ­£ç¢º

**ç¯„ä¾‹ä»»å‹™ï¼šè™•ç†ã€Œæˆ‘æƒ³è£œä¸€ä¸‹æ˜¨å¤©é‚£å ‚èª²çš„å…§å®¹ã€**
```yaml
# åœ¨ intent-rules.yaml æ–°å¢
- intent: record_content
  keywords: ["è£œ", "è¨˜éŒ„", "å…§å®¹", "ä¸Šèª²", "èª²ç¨‹"]
  required_slots: ["timeReference", "courseName", "studentName"]
  priority: 2
  exclude_keywords: ["æŸ¥è©¢", "æŸ¥çœ‹"]
```

```javascript
// extractSlots è™•ç†é‚è¼¯
if (intent === 'record_content') {
  // æ™‚é–“åƒè€ƒè™•ç†
  if (message.includes('æ˜¨å¤©')) {
    slots.timeReference = 'yesterday';
    slots.courseDate = getYesterday();
  }
  // èª²ç¨‹éœ€è¦é€²ä¸€æ­¥è©¢å•æˆ–å¾ä¸Šä¸‹æ–‡å–å¾—
  if (!slots.courseName) {
    needMoreInfo.push('courseName');
  }
}
```

### A6. MVP æ ¸å¿ƒæ„åœ–å¯¦ä½œä»»å‹™

ä»¥ä¸‹æ˜¯ MVP éšæ®µå¿…é ˆå¯¦ä½œçš„ 5 å€‹æ ¸å¿ƒæ„åœ–ï¼Œæ¯å€‹éƒ½åŒ…å«å®Œæ•´çš„é–‹ç™¼è¦æ ¼ï¼š

#### A6.1 æ–°å¢èª²ç¨‹ (add_course)

**ä½¿ç”¨è€…èªå¥ç¯„ä¾‹**ï¼š
- ã€Œå°æ˜æ¯é€±ä¸‰ä¸‹åˆ3é»æ•¸å­¸èª²ã€
- ã€ŒLumi æ˜ŸæœŸäº”è¦ä¸Šé‹¼ç´èª²ã€
- ã€Œå¹«æˆ‘æ’å°å…‰æ˜å¤©ä¸Šåˆ10é»çš„è‹±æ–‡èª²ã€

**Intent é…ç½®**ï¼š
```yaml
- intent: add_course
  keywords: ["ä¸Š", "èª²", "å®‰æ’", "æ’", "æ–°å¢"]
  required_slots: ["studentName", "courseName", "scheduleTime"]
  priority: 1
```

**Slots è³‡æ–™æ ¼å¼**ï¼š
```javascript
{
  studentName: "å°æ˜",           // å¿…å¡«
  courseName: "æ•¸å­¸èª²",          // å¿…å¡«
  scheduleTime: "15:00",         // å¿…å¡«ï¼Œçµ±ä¸€24å°æ™‚åˆ¶
  courseDate: "2025-01-15",      // å–®æ¬¡èª²ç¨‹å¿…å¡«
  recurring: true,               // æ˜¯å¦é‡è¤‡
  dayOfWeek: 3,                  // æ˜ŸæœŸå¹¾ï¼ˆ0=é€±æ—¥ï¼‰
  duration: 60                   // èª²ç¨‹é•·åº¦ï¼ˆåˆ†é˜ï¼‰
}
```

**ä»»å‹™å‡½å¼åç¨±**ï¼š`handle_add_course_task`

**è™•ç†æµç¨‹**ï¼š
1. **é©—è­‰è¼¸å…¥**
   - [ ] æª¢æŸ¥å¿…è¦ slots æ˜¯å¦å­˜åœ¨
   - [ ] é©—è­‰æ™‚é–“æ ¼å¼
   - [ ] ç¢ºèªå­¸ç”Ÿæ˜¯å¦å·²è¨»å†Š

2. **æŸ¥è©¢å­¸ç”Ÿè³‡æ–™**
   - [ ] å‘¼å« `firebaseService.getStudent(userId, studentName)`
   - [ ] å–å¾—å­¸ç”Ÿçš„ calendarId
   - [ ] å¦‚æœå­¸ç”Ÿä¸å­˜åœ¨ï¼Œå…ˆå»ºç«‹å­¸ç”Ÿè³‡æ–™

3. **æª¢æŸ¥æ™‚é–“è¡çª**
   - [ ] å‘¼å« `googleCalendarService.checkConflict()`
   - [ ] å¦‚æœ‰è¡çªï¼Œè©¢å•ä½¿ç”¨è€…æ˜¯å¦ç¹¼çºŒ

4. **å»ºç«‹ Google Calendar äº‹ä»¶**
   - [ ] å‘¼å« `googleCalendarService.createEvent()`
   - [ ] è¨­å®šé‡è¤‡è¦å‰‡ï¼ˆå¦‚é©ç”¨ï¼‰
   - [ ] å–å¾— eventId

5. **å„²å­˜åˆ° Firebase**
   - [ ] å‘¼å« `firebaseService.saveCourse()`
   - [ ] è·¯å¾‘ï¼š`/courses/{courseId}`
   - [ ] åŒ…å« calendarEventId é—œè¯

**å›å‚³æ ¼å¼**ï¼š
```javascript
{
  success: true,
  message: "âœ… å°æ˜æ¯é€±ä¸‰ä¸‹åˆ3:00çš„æ•¸å­¸èª²å·²å®‰æ’å¥½äº†ï¼"
}
```

#### A6.2 æŸ¥è©¢èª²ç¨‹ (query_schedule)

**ä½¿ç”¨è€…èªå¥ç¯„ä¾‹**ï¼š
- ã€Œå°æ˜ä»Šå¤©æœ‰ä»€éº¼èª²ï¼Ÿã€
- ã€ŒæŸ¥è©¢Lumié€™é€±çš„èª²è¡¨ã€
- ã€Œçœ‹ä¸€ä¸‹å°å…‰æ˜å¤©çš„å®‰æ’ã€

**Intent é…ç½®**ï¼š
```yaml
- intent: query_schedule
  keywords: ["æŸ¥è©¢", "æŸ¥çœ‹", "çœ‹", "èª²è¡¨", "å®‰æ’", "æœ‰ä»€éº¼èª²"]
  required_slots: ["studentName", "timeRange"]
  priority: 2
```

**Slots è³‡æ–™æ ¼å¼**ï¼š
```javascript
{
  studentName: "å°æ˜",           // å¿…å¡«
  timeRange: "today",            // today/tomorrow/this_week/next_week
  specificDate: "2025-01-15",    // å…·é«”æ—¥æœŸï¼ˆé¸å¡«ï¼‰
  courseName: "æ•¸å­¸èª²"           // æŸ¥è©¢ç‰¹å®šèª²ç¨‹ï¼ˆé¸å¡«ï¼‰
}
```

**ä»»å‹™å‡½å¼åç¨±**ï¼š`handle_query_schedule_task`

**è™•ç†æµç¨‹**ï¼š
1. **è§£ææ™‚é–“ç¯„åœ**
   - [ ] å°‡ä¸­æ–‡æ™‚é–“è½‰æ›ç‚ºæ—¥æœŸå€é–“
   - [ ] è™•ç†ç›¸å°æ™‚é–“ï¼ˆä»Šå¤©ã€æ˜å¤©ã€é€™é€±ï¼‰

2. **æŸ¥è©¢ Firebase**
   - [ ] å‘¼å« `firebaseService.getCoursesByStudent()`
   - [ ] æŒ‰æ™‚é–“ç¯©é¸èª²ç¨‹
   - [ ] æŒ‰ scheduleTime æ’åº

3. **æ ¼å¼åŒ–å›æ‡‰**
   - [ ] è½‰æ›æ™‚é–“æ ¼å¼ç‚ºä¸­æ–‡é¡¯ç¤º
   - [ ] çµ„ç¹”èª²ç¨‹åˆ—è¡¨
   - [ ] åŠ å…¥å¿«æ·æ“ä½œæŒ‰éˆ•

**å›å‚³æ ¼å¼**ï¼š
```javascript
{
  success: true,
  message: "å°æ˜ä»Šå¤©ï¼ˆ1/15ï¼‰çš„èª²ç¨‹ï¼š\nğŸ“ ä¸Šåˆ10:00 è‹±æ–‡èª²\nğŸ“ ä¸‹åˆ15:00 æ•¸å­¸èª²"
}
```

#### A6.3 è¨­å®šæé†’ (set_reminder)

**ä½¿ç”¨è€…èªå¥ç¯„ä¾‹**ï¼š
- ã€Œæé†’æˆ‘å°æ˜çš„æ•¸å­¸èª²ã€
- ã€Œé‹¼ç´èª²å‰30åˆ†é˜é€šçŸ¥æˆ‘ã€
- ã€Œè¨­å®šæé†’ï¼Œè¨˜å¾—å¸¶èª²æœ¬ã€

**Intent é…ç½®**ï¼š
```yaml
- intent: set_reminder
  keywords: ["æé†’", "é€šçŸ¥", "è¨˜å¾—"]
  required_slots: ["studentName", "courseName"]
  priority: 2
```

**Slots è³‡æ–™æ ¼å¼**ï¼š
```javascript
{
  studentName: "å°æ˜",           // å¿…å¡«
  courseName: "æ•¸å­¸èª²",          // å¿…å¡«
  reminderTime: 30,              // æå‰å¹¾åˆ†é˜ï¼ˆé è¨­30ï¼‰
  reminderNote: "è¨˜å¾—å¸¶èª²æœ¬",    // é™„åŠ æé†’å…§å®¹ï¼ˆé¸å¡«ï¼‰
  specificDate: "2025-01-15"     // ç‰¹å®šæ—¥æœŸçš„èª²ç¨‹ï¼ˆé¸å¡«ï¼‰
}
```

**ä»»å‹™å‡½å¼åç¨±**ï¼š`handle_set_reminder_task`

**è™•ç†æµç¨‹**ï¼š
1. **æŸ¥æ‰¾èª²ç¨‹**
   - [ ] å‘¼å« `firebaseService.findCourse()`
   - [ ] æ ¹æ“šå­¸ç”Ÿã€èª²ç¨‹åç¨±ã€æ—¥æœŸæŸ¥æ‰¾

2. **å»ºç«‹æé†’è¨˜éŒ„**
   - [ ] å‘¼å« `firebaseService.createReminder()`
   - [ ] å„²å­˜åˆ° Firebase `/reminders/{reminderId}`
   - [ ] è¨˜éŒ„èª²ç¨‹IDã€ç”¨æˆ¶IDã€æé†’æ™‚é–“ã€æé†’å…§å®¹

3. **æ›´æ–°èª²ç¨‹æ¨™è¨˜**
   - [ ] å‘¼å« `firebaseService.updateCourse()`
   - [ ] è¨­å®š shouldRemind: true
   - [ ] é—œè¯ reminderId

**âš ï¸ é‡è¦èªªæ˜ï¼šæé†’åŠŸèƒ½åŸ·è¡Œæ©Ÿåˆ¶**
- æé†’åŠŸèƒ½ç”±**å®šæ™‚ä»»å‹™**è§¸ç™¼åŸ·è¡Œï¼ˆéä½¿ç”¨è€…å³æ™‚ç™¼é€ï¼‰
- ç³»çµ±é€é Firebase Scheduled Functions æ¯5åˆ†é˜æƒæ `/reminders` é›†åˆ
- æª¢æŸ¥æ˜¯å¦æœ‰ç¬¦åˆè§¸ç™¼æ¢ä»¶çš„æé†’ï¼ˆèª²ç¨‹é–‹å§‹æ™‚é–“ - reminderTime â‰¤ ç¾åœ¨æ™‚é–“ï¼‰
- ç¬¦åˆæ¢ä»¶æ™‚ï¼Œä¸»å‹•ç™¼é€ LINE Push Message çµ¦å°æ‡‰ä½¿ç”¨è€…
- ç™¼é€å¾Œæ¨™è¨˜è©²æé†’ç‚ºå·²åŸ·è¡Œï¼Œé¿å…é‡è¤‡ç™¼é€

**æé†’å®šæ™‚ä»»å‹™å¯¦ä½œ**ï¼š
```javascript
// functions/scheduledReminder.js
exports.checkReminders = functions.pubsub.schedule('every 5 minutes').onRun(async () => {
  const now = new Date();
  
  // æŸ¥è©¢éœ€è¦ç™¼é€çš„æé†’
  const reminders = await db.collection('reminders')
    .where('executed', '==', false)
    .where('triggerTime', '<=', now)
    .get();
    
  // æ‰¹æ¬¡ç™¼é€æé†’
  for (const reminder of reminders.docs) {
    await sendLineReminder(reminder.data());
    await reminder.ref.update({ executed: true });
  }
});
```

**å›å‚³æ ¼å¼**ï¼š
```javascript
{
  success: true,
  message: "âœ… å°‡åœ¨å°æ˜æ•¸å­¸èª²é–‹å§‹å‰30åˆ†é˜æé†’æ‚¨"
}
```

#### A6.4 è¨˜éŒ„èª²ç¨‹å…§å®¹ (record_content)

**ä½¿ç”¨è€…èªå¥ç¯„ä¾‹**ï¼š
- ã€Œä»Šå¤©å°æ˜çš„æ•¸å­¸èª²å­¸äº†åˆ†æ•¸ã€
- ã€Œè¨˜éŒ„ä¸€ä¸‹Lumiçš„é‹¼ç´èª²å…§å®¹ã€
- ã€Œæˆ‘æƒ³è£œä¸€ä¸‹æ˜¨å¤©é‚£å ‚èª²çš„å…§å®¹ã€
- ä½¿ç”¨è€…å‚³é€ç…§ç‰‡ + æ–‡å­—èªªæ˜

**Intent é…ç½®**ï¼š
```yaml
- intent: record_content
  keywords: ["è¨˜éŒ„", "å­¸äº†", "å…§å®¹", "è£œ", "ä¸Šäº†"]
  required_slots: ["studentName", "courseName", "content"]
  priority: 2
```

**Slots è³‡æ–™æ ¼å¼**ï¼š
```javascript
{
  studentName: "å°æ˜",           // å¿…å¡«
  courseName: "æ•¸å­¸èª²",          // å¿…å¡«
  content: "å­¸äº†åˆ†æ•¸åŠ æ¸›æ³•",     // èª²ç¨‹å…§å®¹ï¼ˆå¿…å¡«ï¼‰
  courseDate: "2025-01-15",      // èª²ç¨‹æ—¥æœŸï¼ˆé è¨­ä»Šå¤©ï¼‰
  photos: [],                    // ç…§ç‰‡é™£åˆ—ï¼ˆé¸å¡«ï¼‰
  timeReference: "today"         // today/yesterday/specific_date
}
```

**ä»»å‹™å‡½å¼åç¨±**ï¼š`handle_record_content_task`

**è™•ç†æµç¨‹**ï¼š
1. **æŸ¥æ‰¾èª²ç¨‹**
   - [ ] æ ¹æ“šå­¸ç”Ÿã€èª²ç¨‹ã€æ—¥æœŸæŸ¥æ‰¾å°æ‡‰èª²ç¨‹
   - [ ] å¦‚æœæ˜¯ã€Œæ˜¨å¤©ã€ç­‰ç›¸å°æ™‚é–“ï¼Œè½‰æ›ç‚ºå…·é«”æ—¥æœŸ

2. **è™•ç†åœ–ç‰‡ä¸Šå‚³**ï¼ˆå¦‚æœ‰åœ–ç‰‡ï¼‰
   - [ ] å‘¼å« `uploadImage()` å‡½å¼è™•ç†æ¯å¼µåœ–ç‰‡
   - [ ] ä¸Šå‚³åˆ° Firebase Storageï¼š`/courses-images/{courseId}/{timestamp}`
   - [ ] å–å¾—å…¬é–‹åœ–ç‰‡ç¶²å€
   - [ ] å°‡åœ–ç‰‡ç¶²å€åŠ å…¥ photos é™£åˆ—

3. **æ›´æ–°èª²ç¨‹è¨˜éŒ„**
   - [ ] å‘¼å« `firebaseService.updateCourseRecord()`
   - [ ] è·¯å¾‘ï¼š`/courses/{courseId}/courseRecord`
   - [ ] ç´¯åŠ å…§å®¹ï¼Œä¸è¦†è“‹æ—¢æœ‰è¨˜éŒ„
   - [ ] å¯«å…¥åœ–ç‰‡ç¶²å€åˆ° photos æ¬„ä½

**âš ï¸ é‡è¦èªªæ˜ï¼šåœ–ç‰‡ä¸Šå‚³åŠŸèƒ½å¯¦ä½œ**

**uploadImage() å‡½å¼è¦æ ¼**ï¼š
```javascript
/**
 * ä¸Šå‚³åœ–ç‰‡åˆ° Firebase Storage
 * @param {Buffer} imageBuffer - åœ–ç‰‡äºŒé€²ä½è³‡æ–™
 * @param {string} courseId - èª²ç¨‹ID
 * @param {string} fileName - æª”æ¡ˆåç¨±
 * @returns {Promise<string>} å…¬é–‹åœ–ç‰‡ç¶²å€
 */
async function uploadImage(imageBuffer, courseId, fileName) {
  try {
    // 1. å»ºç«‹ Storage åƒè€ƒè·¯å¾‘
    const storageRef = admin.storage().bucket().file(`courses-images/${courseId}/${fileName}`);
    
    // 2. ä¸Šå‚³åœ–ç‰‡
    await storageRef.save(imageBuffer, {
      metadata: {
        contentType: 'image/jpeg',
        cacheControl: 'public, max-age=31536000'
      }
    });
    
    // 3. è¨­å®šå…¬é–‹å­˜å–æ¬Šé™
    await storageRef.makePublic();
    
    // 4. å›å‚³å…¬é–‹ç¶²å€
    const publicUrl = `https://storage.googleapis.com/${bucket.name}/${storageRef.name}`;
    return publicUrl;
    
  } catch (error) {
    console.error('Image upload failed:', error);
    throw new Error('åœ–ç‰‡ä¸Šå‚³å¤±æ•—');
  }
}
```

**åœ–ç‰‡è™•ç†å®Œæ•´æµç¨‹**ï¼š
1. ä½¿ç”¨è€…é€é LINE å‚³é€åœ–ç‰‡
2. Bot æ¥æ”¶åœ–ç‰‡ä¸¦ä¸‹è¼‰ç‚º Buffer
3. å‘¼å« `uploadImage()` ä¸Šå‚³åˆ° Firebase Storage
4. å–å¾—å…¬é–‹åœ–ç‰‡ç¶²å€
5. å°‡ç¶²å€å¯«å…¥ Firebase `/courses/{courseId}/courseRecord/photos` é™£åˆ—
6. å›å‚³ç¢ºèªè¨Šæ¯çµ¦ä½¿ç”¨è€…

**å›å‚³æ ¼å¼**ï¼š
```javascript
{
  success: true,
  message: "âœ… å·²è¨˜éŒ„å°æ˜1/15æ•¸å­¸èª²çš„å…§å®¹ï¼šå­¸äº†åˆ†æ•¸åŠ æ¸›æ³•ï¼ˆå«2å¼µç…§ç‰‡ï¼‰"
}
```

#### A6.5 åˆªé™¤èª²ç¨‹ (cancel_course)

**ä½¿ç”¨è€…èªå¥ç¯„ä¾‹**ï¼š
- ã€Œå–æ¶ˆå°æ˜æ˜å¤©çš„æ•¸å­¸èª²ã€
- ã€Œåˆªæ‰Lumiçš„é‹¼ç´èª²ã€
- ã€Œä¸ä¸Šè‹±æ–‡èª²äº†ã€

**Intent é…ç½®**ï¼š
```yaml
- intent: cancel_course
  keywords: ["å–æ¶ˆ", "åˆªé™¤", "åˆªæ‰", "ä¸ä¸Š"]
  required_slots: ["studentName", "courseName"]
  priority: 2
```

**Slots è³‡æ–™æ ¼å¼**ï¼š
```javascript
{
  studentName: "å°æ˜",           // å¿…å¡«
  courseName: "æ•¸å­¸èª²",          // å¿…å¡«
  scope: "single",               // single/recurring/all
  specificDate: "2025-01-15",    // å–æ¶ˆç‰¹å®šæ—¥æœŸï¼ˆé¸å¡«ï¼‰
  reason: "ç”Ÿç—…"                 // å–æ¶ˆåŸå› ï¼ˆé¸å¡«ï¼‰
}
```

**ä»»å‹™å‡½å¼åç¨±**ï¼š`handle_cancel_course_task`

**è™•ç†æµç¨‹**ï¼š
1. **ç¢ºèªå–æ¶ˆç¯„åœ**
   - [ ] è©¢å•æ˜¯å–®æ¬¡é‚„æ˜¯æ•´å€‹é‡è¤‡èª²ç¨‹
   - [ ] é¡¯ç¤ºèª²ç¨‹è³‡è¨Šè®“ä½¿ç”¨è€…ç¢ºèª

2. **åˆªé™¤ Google Calendar äº‹ä»¶**
   - [ ] å‘¼å« `googleCalendarService.deleteEvent()`
   - [ ] è™•ç†é‡è¤‡äº‹ä»¶çš„éƒ¨åˆ†åˆªé™¤

3. **æ›´æ–° Firebase**
   - [ ] å–®æ¬¡ï¼šæ¨™è¨˜ cancelled: true
   - [ ] é‡è¤‡ï¼šåˆªé™¤æ•´ç­†è¨˜éŒ„
   - [ ] ä¿ç•™æ­·å²è¨˜éŒ„ä¾›æŸ¥è©¢

**å›å‚³æ ¼å¼**ï¼š
```javascript
{
  success: true,
  message: "âœ… å·²å–æ¶ˆå°æ˜æ˜å¤©ï¼ˆ1/16ï¼‰çš„æ•¸å­¸èª²"
}
```

### A7. æ¯é€±å­¸ç¿’æˆæœæ‘˜è¦å¡ç‰‡ä»»å‹™ï¼ˆAI ç”Ÿæˆï¼Œå®šæ™‚ä»»å‹™ï¼‰

æ¯é€±å…­ä¸Šåˆ 10:00ï¼Œè‡ªå‹•åŸ·è¡Œä»¥ä¸‹æµç¨‹ï¼Œå‘å®¶é•·æ¨æ’­ä¸€å¼µå­¸ç¿’æ‘˜è¦åœ–ç‰‡å¡ï¼š

1. æŸ¥è©¢ Firebase ä¸­è©²å­¸ç”Ÿéå» 7 å¤©å…§çš„èª²ç¨‹è³‡æ–™ï¼ˆ`courses` / `course_content`ï¼‰ï¼Œå½™æ•´èª²åã€å…§å®¹èˆ‡åœ–ç‰‡ã€‚

2. å‘¼å« AI æ¨¡å‹ï¼ˆå¦‚ GPT-3.5ï¼‰ç”Ÿæˆä¸€æ®µæ–‡å­—æ‘˜è¦ï¼Œå…§å®¹åŒ…æ‹¬ï¼š
   - æœ¬é€±å­¸ç¿’äº®é»
   - ä¸Šèª²è¡¨ç¾èˆ‡é€²åº¦
   - æ¨è–¦é¼“å‹µèªå¥ï¼ˆæº«æš–ã€æ­£å‘ã€å£èªåŒ–ï¼‰

3. èƒŒæ™¯åœ–ç‰‡ç”Ÿæˆé‚è¼¯ï¼š
   - **è‹¥è©²å­¸ç”Ÿéå» 7 å¤©å…§æœ‰èª²ç¨‹åœ–ç‰‡**ï¼ŒæŒ‘é¸å…¶ä¸­ä¸€å¼µä»£è¡¨æ€§åœ–ç‰‡ï¼Œé€å…¥é¢¨æ ¼è½‰æ›æ¨¡å‹ï¼ˆå¦‚ Replicate æˆ– Stability APIï¼‰ï¼Œä½¿ç”¨ promptï¼š
     ```
     Studio Ghibli style childrenâ€™s learning moment illustration, warm color, dreamy, cinematic
     ```
   - **è‹¥ç„¡åœ–ç‰‡å¯ç”¨**ï¼Œå‰‡æ ¹æ“šæœ¬é€±æœ€å¤šçš„èª²ç¨‹é¡å‹ï¼ˆå¦‚é‹¼ç´ã€ç¾è¡“ã€ç§‘å­¸ï¼‰ï¼Œå‘¼å« AI åœ–ç‰‡ç”Ÿæˆ APIï¼ˆå¦‚ DALLÂ·Eï¼‰è¼¸å…¥èƒŒæ™¯ promptï¼š

     ```
     Studio Ghibli styleA cheerful and heartwarming children's learning background, with soft colors, suitable for weekly report card; theme: {èª²ç¨‹ä¸»é¡Œ}, warm lighting, 1080x1080
     ```

4. ä½¿ç”¨ `node-canvas` åˆæˆåœ–ç‰‡å¡ç‰‡ï¼Œæ­¥é©Ÿå¦‚ä¸‹ï¼š
   - è¼‰å…¥èƒŒæ™¯åœ–ï¼ˆé¢¨æ ¼è½‰æ›åœ– æˆ– AI èƒŒæ™¯åœ–ï¼‰ä½œç‚ºåº•åœ–
   - å°‡æ–‡å­—æ‘˜è¦åŠ ä¸Šè‡ªå‹•æ’ç‰ˆï¼Œç¹ªè£½åœ¨åœ–ä¸­å¤®åä¸Šä½ç½®ï¼ˆæœ€å¤šä¸‰æ®µï¼‰
   - åœ–ç‰‡å³ä¸‹è§’åŠ å…¥æ°´å°ï¼š**ã€Œ{å­¸ç”Ÿåç¨±}@èª²èª²é€šã€**ï¼ˆç™½å­— + åŠé€æ˜æ·±è‰²èƒŒæ™¯ï¼‰
   - åœ–ç‰‡è§£æåº¦ç‚º 1080 x 1080ï¼ŒåŒ¯å‡ºç‚º PNG

   ```ts
   composeSummaryCard(text: string, imageUrl: string, studentName: string): Buffer
   ```

5. å°‡ç”Ÿæˆçš„åœ–ç‰‡å¡ä¸Šå‚³è‡³ Firebase Storageï¼Œå–å¾—å…¬é–‹é€£çµ URLã€‚

6. é€é LINE æ¨æ’­ API ç™¼é€åœ–ç‰‡å¡çµ¦å°æ‡‰å®¶é•·å¸³è™Ÿï¼š

   ```ts
   sendLinePush(userId: string, imageUrl: string): Promise<void>
   ```

---

ğŸ“Œ **æ³¨æ„äº‹é …ï¼š**
- å¤šå­å¥³å®¶åº­æ‡‰åˆ†åˆ¥ç”Ÿæˆèˆ‡æ¨æ’­
- è‹¥è³‡æ–™éå°‘ï¼Œå¯ç”Ÿæˆé€šç”¨è¨Šæ¯ + æ’å…¥éå»å…§å®¹
- èƒŒæ™¯åœ–å„ªå…ˆä½¿ç”¨èª²å ‚ç…§ç‰‡è½‰åœ–é¢¨ï¼Œè‹¥å¤±æ•—å‰‡é€€å› AI ä¸»é¡Œç”Ÿæˆ
- å¯è€ƒæ…®é‡å°èª²ç¨‹é¡å‹è¨­è¨ˆä¸€å¥—ä¸»é¡Œåœ–èƒŒæ™¯ Prompt åƒæ•¸æ¨¡æ¿ï¼ˆå»¶ä¼¸ç™¼å±•ï¼‰

---

ğŸ”§ **å°æ‡‰å‡½å¼èˆ‡æ¨¡çµ„ï¼š**

| å‡½å¼åç¨± | åŠŸèƒ½èªªæ˜ |
|----------|-----------|
| `generateWeeklySummary(studentId)` | ç”Ÿæˆæ–‡å­—æ‘˜è¦ï¼ˆä½¿ç”¨ GPTï¼‰ |
| `generateWeeklyImage(theme)` | AI ç”¢ç”Ÿå‰åœåŠ›é¢¨æ ¼èƒŒæ™¯åœ–ç‰‡ |
| `convertPhotoToGhibliStyle(image)` | èª²å ‚ç…§ç‰‡è½‰å‰åœåŠ›é¢¨åœ–ï¼ˆé¢¨æ ¼è½‰æ›ï¼‰ |
| `composeSummaryCard(text, image, studentName)` | åˆæˆåœ–å¡ï¼ˆæ–‡å­— + åœ–ç‰‡ + æ°´å°ï¼‰ |
| `uploadToStorage(buffer)` | ä¸Šå‚³åœ–å¡è‡³ Firebase Storage |
| `sendLinePush(userId, imageUrl)` | ç™¼é€ LINE åœ–ç‰‡è¨Šæ¯ |

---

## ğŸ”§ B. ç¶­è­·å„ªåŒ–ä»»å‹™

### B1. ç¨‹å¼ç¢¼é‡æ§‹

**ä»»å‹™ç›®æ¨™**ï¼šæ”¹å–„ç¨‹å¼ç¢¼å“è³ªè€Œä¸æ”¹è®ŠåŠŸèƒ½ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **è­˜åˆ¥é‡æ§‹ç›®æ¨™**
   - [ ] ä½¿ç”¨ `npm run lint` æª¢æŸ¥ç¨‹å¼ç¢¼å“è³ª
   - [ ] æ‰¾å‡ºé‡è¤‡çš„ç¨‹å¼ç¢¼ç‰‡æ®µ
   - [ ] è­˜åˆ¥éé•·çš„å‡½å¼ï¼ˆè¶…é 50 è¡Œï¼‰

2. **é‡æ§‹å¯¦æ–½**
   - [ ] æå–å…±ç”¨å‡½å¼åˆ° `/src/utils/`
   - [ ] åˆ†è§£è¤‡é›œå‡½å¼
   - [ ] çµ±ä¸€éŒ¯èª¤è™•ç†æ¨¡å¼
   - [ ] æ”¹å–„è®Šæ•¸å‘½å

3. **é©—è­‰æ¸¬è©¦**
   - [ ] åŸ·è¡Œ `npm run lint:fix`
   - [ ] æ¸¬è©¦æ‰€æœ‰å—å½±éŸ¿çš„åŠŸèƒ½
   - [ ] ç¢ºèªè¡Œç‚ºæ²’æœ‰æ”¹è®Š

### B2. æ•ˆèƒ½å„ªåŒ–

**ä»»å‹™ç›®æ¨™**ï¼šæå‡ç³»çµ±å›æ‡‰é€Ÿåº¦å’Œè³‡æºä½¿ç”¨æ•ˆç‡ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **æ•ˆèƒ½åˆ†æ**
   - [ ] è­˜åˆ¥ç“¶é ¸ï¼ˆAPI å‘¼å«ã€è³‡æ–™åº«æŸ¥è©¢ï¼‰
   - [ ] æ¸¬é‡ç¾æœ‰å›æ‡‰æ™‚é–“
   - [ ] è¨­å®šå„ªåŒ–ç›®æ¨™

2. **å„ªåŒ–å¯¦æ–½**
   - [ ] å¯¦æ–½å¿«å–ç­–ç•¥ï¼ˆè¨˜æ†¶é«”æˆ– Redisï¼‰
   - [ ] å„ªåŒ–è³‡æ–™åº«æŸ¥è©¢ï¼ˆåŠ å…¥ç´¢å¼•ï¼‰
   - [ ] æ¸›å°‘ä¸å¿…è¦çš„ API å‘¼å«
   - [ ] å¯¦æ–½æ‰¹æ¬¡è™•ç†

3. **æ•ˆæœé©—è­‰**
   - [ ] æ¸¬é‡å„ªåŒ–å¾Œçš„å›æ‡‰æ™‚é–“
   - [ ] ç›£æ§è³‡æºä½¿ç”¨æƒ…æ³
   - [ ] ç¢ºä¿åŠŸèƒ½æ­£ç¢ºæ€§

### B3. éŒ¯èª¤ä¿®å¾©

**ä»»å‹™ç›®æ¨™**ï¼šä¿®å¾©å·²çŸ¥çš„ç¨‹å¼éŒ¯èª¤ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **å•é¡Œé‡ç¾**
   - [ ] æ ¹æ“šéŒ¯èª¤å ±å‘Šé‡ç¾å•é¡Œ
   - [ ] æ”¶é›†éŒ¯èª¤æ—¥èªŒ
   - [ ] ç¢ºèªå½±éŸ¿ç¯„åœ

2. **æ ¹å› åˆ†æ**
   - [ ] è¿½è¹¤éŒ¯èª¤å †ç–Š
   - [ ] æ‰¾å‡ºéŒ¯èª¤æ ¹æº
   - [ ] è©•ä¼°ä¿®å¾©æ–¹æ¡ˆ

3. **ä¿®å¾©å¯¦æ–½**
   - [ ] å¯¦ä½œä¿®å¾©ç¨‹å¼ç¢¼
   - [ ] åŠ å…¥é˜²ç¦¦æ€§ç¨‹å¼è¨­è¨ˆ
   - [ ] æ”¹å–„éŒ¯èª¤è¨Šæ¯

4. **è¿´æ­¸æ¸¬è©¦**
   - [ ] é©—è­‰éŒ¯èª¤å·²ä¿®å¾©
   - [ ] æ¸¬è©¦ç›¸é—œåŠŸèƒ½
   - [ ] ç¢ºä¿æ²’æœ‰å¼•å…¥æ–°å•é¡Œ

---

## âš™ï¸ C. é…ç½®ç®¡ç†ä»»å‹™

### C1. ç’°å¢ƒè®Šæ•¸è¨­å®š

**ä»»å‹™ç›®æ¨™**ï¼šæ–°å¢æˆ–ä¿®æ”¹ç’°å¢ƒè®Šæ•¸é…ç½®ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **æ›´æ–°é…ç½®æª”æ¡ˆ**
   - [ ] ç·¨è¼¯ `.env.example`
   - [ ] åŠ å…¥è®Šæ•¸èªªæ˜è¨»è§£
   - [ ] æä¾›ç¯„ä¾‹å€¼

2. **ç¨‹å¼ç¢¼æ•´åˆ**
   - [ ] åœ¨ç›¸é—œæ¨¡çµ„ä¸­è®€å–ç’°å¢ƒè®Šæ•¸
   - [ ] åŠ å…¥é è¨­å€¼è™•ç†
   - [ ] é©—è­‰å¿…è¦è®Šæ•¸å­˜åœ¨

3. **æ–‡ä»¶æ›´æ–°**
   - [ ] æ›´æ–° README çš„ç’°å¢ƒè¨­å®šç« ç¯€
   - [ ] èªªæ˜è®Šæ•¸ç”¨é€”å’Œæ ¼å¼
   - [ ] æä¾›è¨­å®šç¯„ä¾‹

### C2. Feature Flag èª¿æ•´

**ä»»å‹™ç›®æ¨™**ï¼šå•Ÿç”¨æˆ–é—œé–‰ç‰¹å®šåŠŸèƒ½ã€‚

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. **è©•ä¼°å½±éŸ¿**
   - [ ] æŸ¥çœ‹ `/src/config/features.js`
   - [ ] äº†è§£åŠŸèƒ½çš„ä¾è³´é—œä¿‚
   - [ ] ç¢ºèªæ˜¯å¦éœ€è¦è³‡æ–™é·ç§»

2. **èª¿æ•´è¨­å®š**
   - [ ] ä¿®æ”¹ feature flag çš„ enabled ç‹€æ…‹
   - [ ] è¨­å®š rolloutPercentageï¼ˆå¦‚éœ€è¦ï¼‰
   - [ ] æ›´æ–° enabledUsers ç™½åå–®ï¼ˆå¦‚éœ€è¦ï¼‰

3. **æ¸¬è©¦é©—è­‰**
   - [ ] æ¸¬è©¦åŠŸèƒ½é–‹é—œæ•ˆæœ
   - [ ] ç¢ºèªé™ç´šæ©Ÿåˆ¶æ­£å¸¸
   - [ ] ç›£æ§ç³»çµ±ç©©å®šæ€§

---

## ğŸ“ ä»»å‹™åŸ·è¡Œæª¢æŸ¥æ¸…å–®

æ¯å€‹ä»»å‹™åŸ·è¡Œå‰å¾Œéƒ½æ‡‰è©²ï¼š

**åŸ·è¡Œå‰**ï¼š
- [ ] é–±è®€ç›¸é—œæ–‡ä»¶ï¼ˆimplement.mdã€developer-guide.mdï¼‰
- [ ] ç¢ºèªé–‹ç™¼ç’°å¢ƒæ­£å¸¸ï¼ˆnpm installã€ç’°å¢ƒè®Šæ•¸ï¼‰
- [ ] æ‹‰å–æœ€æ–°ç¨‹å¼ç¢¼ï¼ˆgit pullï¼‰

**åŸ·è¡Œä¸­**ï¼š
- [ ] éµå¾ªå‘½åè¦ç¯„ï¼ˆåƒè€ƒ claude.mdï¼‰
- [ ] ä¿æŒç¨‹å¼ç¢¼é¢¨æ ¼ä¸€è‡´ï¼ˆä½¿ç”¨ npm run lint:fixï¼‰
- [ ] é©æ™‚æäº¤é€²åº¦ï¼ˆgit commitï¼‰

**åŸ·è¡Œå¾Œ**ï¼š
- [ ] åŸ·è¡Œæ ¼å¼æª¢æŸ¥ï¼ˆnpm run lintï¼‰
- [ ] æ¸¬è©¦æ‰€æœ‰ç›¸é—œåŠŸèƒ½
- [ ] æ›´æ–°ç›¸é—œæ–‡ä»¶
- [ ] æ¸…ç†æ¸¬è©¦è³‡æ–™

---

## ğŸš€ å¿«é€Ÿä»»å‹™ç¯„æœ¬

### å¿«é€Ÿæ–°å¢æŸ¥è©¢æ„åœ–
```bash
# 1. æ–°å¢æ„åœ–è¦å‰‡
echo "- intent: query_[something]
  keywords: [\"æŸ¥è©¢\", \"æŸ¥çœ‹\", \"é¡¯ç¤º\"]
  required_slots: [\"studentName\", \"dateRange\"]" >> /config/mvp/intent-rules.yaml

# 2. å»ºç«‹ä»»å‹™è™•ç†å™¨
touch /src/tasks/handle_query_[something]_task.js

# 3. æ¸¬è©¦æ–°åŠŸèƒ½
node tools/send-test-message.js "æŸ¥è©¢å°æ˜æœ¬é€±çš„[something]"
```

### å¿«é€Ÿä¿®å¾©éŒ¯èª¤
```bash
# 1. æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
npm start | grep ERROR

# 2. å®šä½å•é¡Œæª”æ¡ˆ
grep -r "éŒ¯èª¤é—œéµå­—" /src

# 3. ä¿®å¾©ä¸¦æ¸¬è©¦
npm run lint:fix
node tools/send-test-message.js "è§¸ç™¼éŒ¯èª¤çš„è¨Šæ¯"
```

---

## ğŸ“Œ æ³¨æ„äº‹é …

1. **ç¬¬ä¸€æ€§åŸå‰‡**ï¼šæ¯å€‹ä»»å‹™éƒ½è¦æ€è€ƒã€Œç‚ºä»€éº¼è¦é€™æ¨£åšã€
2. **ä¿æŒç°¡å–®**ï¼šMVP éšæ®µé¿å…éåº¦è¨­è¨ˆ
3. **ä½¿ç”¨è€…å„ªå…ˆ**ï¼šæ‰€æœ‰æ”¹å‹•éƒ½è¦è€ƒæ…®å°ä½¿ç”¨è€…é«”é©—çš„å½±éŸ¿
4. **æ–‡ä»¶åŒæ­¥**ï¼šç¨‹å¼ç¢¼æ”¹å‹•å¾Œè¨˜å¾—æ›´æ–°ç›¸é—œæ–‡ä»¶

æœ¬è¦åŠƒè¡¨æœƒéš¨è‘—å°ˆæ¡ˆæ¼”é€²æŒçºŒæ›´æ–°ã€‚