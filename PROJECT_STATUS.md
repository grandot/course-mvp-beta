# 專案工作板（單一資訊來源）

### Doing
- 重複課程功能完整實作 [uid:0236f790] [key:重複課程功能完整實作]
### Next
- deleteDocument 集合白名單（僅允許刪除 courses/reminders/course_contents｜規格: doc/developer-guide.md） [uid:79cd3934] [key:集合白名單-僅允許刪除-coursecontents-courses-deletedocument-reminders]
- 除了測試的日曆，正常用戶的日曆不可刪除。如果用戶下達刪除指令，改變status不要物理刪除。 [uid:80a5f26b] [key:不要物理刪除-正常用戶的日曆不可刪除-如果用戶下達刪除指令-改變-除了測試的日曆-status]
- 確認GCal跟firebase是否同步（新增/刪除/修改） [uid:14df74bf] [key:刪除-是否同步-修改-新增-跟-確認-firebase-gcal]
- 衝突檢查條件化（僅在日期/時間變更時檢查｜規格: spec/modify-course/plan.md） [uid:e6e94331] [key:時間變更時檢查-僅在日期-衝突檢查條件化]
- 每月「第N個週X」重複（P1；RRULE: BYDAY+BYSETPOS；支援「最後一個週X」；起始日推導；成功訊息校準｜規格: spec/recurring/task-recurring.md） [uid:03c515ef] [key:成功訊息校準-重複-個週-起始日推導-第-最後一個週-byday-bysetpos-n-p1-rrule-x]
- 直接修改「重複系列」（P1；限改時間/課名、無例外日；目前 P0 為撤銷＋重建策略｜規格: spec/modify-course/plan.md） [uid:75f9d3cd] [key:目前-直接修改-為撤銷-重建策略-重複系列-限改時間-無例外日-課名-p0-p1]
- 撤銷時限共用介面（P1；抽出 `src/utils/timeWindow.js`，供新增/修改/撤銷共用） [uid:c8c7954b] [key:供新增-抽出-修改-撤銷共用-撤銷時限共用介面-js-p1-src-timewindow-utils]
- 小月提示互動強化（P1；提供 Quick Reply 選項，避免誤解｜規格: spec/recurring/task-recurring.md） [uid:22045b71] [key:小月提示互動強化-提供-選項-避免誤解-p1-quick-reply]
- 測試與文件補強（P1；新增「每月第N個週X」端到端用例與 QA 報告；校準 `README` 與規格文件） [uid:3d6361bb] [key:每月第-個週-測試與文件補強-新增-端到端用例與-與規格文件-n-p1-qa-readme-x]
- 單元測試補齊（需求定義完成；尚未開工） [uid:ca22a173] [key:尚未開工-單元測試補齊-需求定義完成]
- 開關文件同步（`config/env.example`、`README` 補充 `ENABLE_RECURRING_COURSES` 與舊變數相容性說明） [uid:51c93f0f] [key:開關文件同步-補充-與舊變數相容性說明-config-enablerecurringcourses-env-example-readme]
- Render 健檢 400 校準（健檢/Redis 檢查使用免簽名端點或加入測試標頭 x-qa-mode:test；更新 `tools/render-suite.js`） [uid:992cf49f] [key:400-更新-健檢-檢查使用免簽名端點或加入測試標頭-js-mode-qa-redis-render-suite-test-tools-x]
- 修改課程成功訊息優化（僅改課名時以「已更新課名為 X」簡短回饋｜規格: spec/modify-course/task.md） [uid:dba2e174] [key:已更新課名為-修改課程成功訊息優化-僅改課名時以-簡短回饋-x]
### Backlog
- 批次操作（一次新增多個課程） [uid:bcf24ae7] [key:一次新增多個課程-批次操作]
- 匯出 PDF 課程報表 [uid:777286a4] [key:匯出-課程報表-pdf]
- 搜尋特定課程/內容 [uid:94476975] [key:內容-搜尋特定課程]
- 無變更保護（修改課程無實質變更時不更新，提示引導） [uid:e38bfd4c] [key:修改課程無實質變更時不更新-提示引導-無變更保護]
- 監控告警（異常監控與即時告警） [uid:8dfea4f7] [key:異常監控與即時告警-監控告警]
- Redis 連接池與延遲優化 [uid:6098a343] [key:連接池與延遲優化-redis]
- Rate limiting 與輸入驗證 [uid:45d821a0] [key:與輸入驗證-limiting-rate]
- 課名提取強化（cleanCourseName 句式擴充與動作詞容錯｜規格: spec/modify-course/plan.md） [uid:a5211dd9] [key:句式擴充與動作詞容錯-課名提取強化-cleancoursename]
- 時區一致性整理（統一 Asia/Taipei +08:00 的解析/顯示與過去時間判斷） [uid:c148310a] [key:00-08-的解析-時區一致性整理-統一-顯示與過去時間判斷-asia-taipei]
- 衝突檢查排除自身事件（修改時忽略當前事件，避免自我衝突） [uid:ec93c1f3] [key:修改時忽略當前事件-衝突檢查排除自身事件-避免自我衝突]
- 已固定 Asia/Taipei（+08:00）並處理跨日進位；符合目前產品市場。若未來跨時區，需抽象化。 [uid:2ec086af] [key:00-08-已固定-並處理跨日進位-若未來跨時區-符合目前產品市場-需抽象化-asia-taipei]
- 測試報告存證與口徑統一（所有測試輸出以 tee 落檔；彙整報告僅讀檔案數據，避免批次口徑差） [uid:40fc8143] [key:所有測試輸出以-測試報告存證與口徑統一-彙整報告僅讀檔案數據-落檔-避免批次口徑差-tee]
- 測試標準化與差異守門（同旗標配置、userId 隔離；一致性差異門檻警示） [uid:41c34442] [key:一致性差異門檻警示-同旗標配置-測試標準化與差異守門-隔離-userid]
- 覆蓋率管線（整合 nyc/jest 產出 coverage，納入 QA 報告） [uid:37685956] [key:納入-產出-整合-覆蓋率管線-coverage-jest-nyc-qa]
- 旗標汰換（逐步移除 `ENABLE_DAILY_RECURRING`，僅保留 `ENABLE_RECURRING_COURSES`，清理 deprecation log） [uid:0133b2c0] [key:清理-逐步移除-僅保留-旗標汰換-deprecation-enabledailyrecurring-enablerecurringcourses-log]
### Blocked
- 圖片上傳 404（LINE API）— 需官方支援或替代流程決策 [uid:e424a45a] [key:404-圖片上傳-需官方支援或替代流程決策-api-line]
### Done
- 2025-08-13：修改課程功能（modify_course v1 完成｜規格: spec/modify-course/plan.md） [uid:ceab455d] [key:修改課程功能-modifycourse-v1]
- 2025-08-13：時間格式統一（訊息固定顯示 :mm；00:xx → 上午12:xx） [uid:9eaa05c2] [key:00-12-上午-時間格式統一-訊息固定顯示-mm-xx]
- 2025-08-12：新增課程時日曆未寫入成功，但是firebase寫入成功 [uid:35c38d0e] [key:但是-新增課程時日曆未寫入成功-寫入成功-firebase]
- 2025-08-12：**確認按鈕功能恢復**（AI prompt + 規則兜底雙重保險，確保「確認」100% 識別） [uid:679a56d2] [key:100-規則兜底雙重保險-確保-確認-確認按鈕功能恢復-識別-ai-prompt]
- 2025-08-12：**Google Calendar 同步修復**（環境變數載入修復，課程直接寫入日曆） [uid:963526f1] [key:同步修復-課程直接寫入日曆-環境變數載入修復-calendar-google]
