# 多子女課程管理 - 需求分析

## 🎯 核心需求

### 用戶故事
作為一個有多個子女的家長，我希望：
1. 能用自然語言區分不同子女的課程
2. 查看課程時能清楚看到是哪個子女的課程
3. 不需要學習新的操作方式

### 測試案例
1. **輸入**: "小明明天下午兩點鋼琴課"  
   **期望**: 創建課程，顯示時包含「小明」標識

2. **輸入**: "小美每週三早上十點法語課"  
   **期望**: 創建重複課程，顯示時包含「小美」標識

## 🧠 設計理由 - 第一性原則

### 問題本質
**核心問題**: 如何區分不同子女的課程？
**本質需求**: 在課程信息中包含子女標識

### 解決方案評估

#### 方案 A: 語義嵌入法（推薦）
```javascript
// 在語義層處理，將子女名嵌入課程名稱
"小明鋼琴課" // course_name 直接包含子女信息
```

**優點**:
- ✅ 最簡單直接的解決方案
- ✅ 符合用戶直覺
- ✅ 零架構改動
- ✅ 實現成本極低

**缺點**:
- ⚠️ 無法進行複雜的子女數據分析（MVP 階段不需要）

#### 方案 B: 複雜實體系統（不推薦）
```javascript
// 建立完整的子女實體系統
children 集合 + user_profiles 集合 + 關聯邏輯
```

**優點**:
- 支持複雜的子女管理功能

**缺點**:
- ❌ 過度工程化
- ❌ 違反 MVP 原則
- ❌ 實現成本高（7天 vs 4小時）
- ❌ 引入架構複雜性
- ❌ 增加系統維護成本

## 🎯 設計決策

### 採用語義嵌入法的理由

1. **遵循 MVP 原則**
   - 最快驗證核心功能
   - 最小實現成本
   - 最低風險

2. **符合第一性原則**
   - 直接解決問題本質
   - 避免不必要的抽象
   - 保持系統簡潔

3. **用戶體驗優先**
   - 自然語言輸入不變
   - 顯示清晰直觀
   - 無學習成本

4. **技術債務最小化**
   - 不引入新的數據結構
   - 不破壞現有架構
   - 未來可漸進式擴展

## 📋 功能範圍

### 包含功能
- ✅ 識別子女名稱（2-4個中文字符）
- ✅ 將子女名稱嵌入課程名稱
- ✅ 查詢時顯示子女信息
- ✅ 支持現有所有課程操作

### 不包含功能（MVP 階段）
- ❌ 子女檔案管理
- ❌ 子女切換功能
- ❌ 按子女統計分析
- ❌ 子女偏好設置

## 🔒 約束條件

1. **向後兼容性 100%**
   - 現有課程數據不受影響
   - 現有 API 不需修改
   - 現有用戶體驗保持

2. **架構不變性**
   - 保持三層語義架構
   - 遵守 Single Source of Truth
   - 不增加新的服務層

3. **實施時間 < 1天**
   - 專注核心功能
   - 避免範圍蔓延
   - 快速交付價值

## 📊 成功指標

1. **功能指標**
   - 子女名稱識別準確率 > 90%
   - 支持 2-4 個中文字符的名稱
   - 課程顯示包含子女信息

2. **技術指標**
   - 代碼改動 < 200 行
   - 性能無明顯影響
   - 零架構變更

3. **用戶體驗指標**
   - 無需用戶培訓
   - 自然語言表達流暢
   - 顯示信息清晰

## 🚀 未來擴展

若未來需要更複雜的子女管理功能，可考慮：
1. 添加 child_tag 字段（最小改動）
2. 實現子女過濾功能
3. 逐步引入子女統計

但這些都應在 MVP 驗證成功後再考慮。