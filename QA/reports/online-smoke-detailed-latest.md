### 線上 Smoke 測試詳細報告（彙整自既有輸出，未重跑）

- 來源報告：`QA/reports/online-smoke-2025-08-13T07-44-57Z.md`
- 日誌摘要：`test-results/render-logs/trace-summary-2025-08-13T07-45-14-601Z.md`
- 目標環境：`https://course-mvp-beta.onrender.com`

### 總覽
- 本機結果：14 測試，12 通過，2 失敗（通過率 86%）
- 線上結果：14 測試，8 通過，6 失敗（通過率 57%）
- 本機 vs 線上一致性：57%（差異 6）

### 關鍵通過案例（節選）
- A1.1-B 時間格式多樣性（美式 PM/AM）：PASS
- A1.1-C 中文數字時間（十點三十分）：PASS
- A1.3-B 過去時間（昨日下午）：線上 PASS（本機 FAIL）
- A2.1-A 每週重複課程（標準）：PASS
- A2.1-B 多天每週重複（一三五）：PASS
- A2.2-A 重複關鍵詞識別（定期/每週）：PASS
- A2.2-B 模糊重複表達（每個星期四）：PASS

### 失敗案例與診斷
- A2.1-C 每日重複課程（功能開啟）：FAIL
  - 實際回覆：系統追問「課程日期」。
  - 研判原因：每日重複在槽位/任務層未提供「起始日期」預設；導致流程落入「缺日期→追問」而非直接建立 RRULE。
  - 建議修正：
    - 若 `recurrenceType === 'daily'` 且未提供日期，採預設起始日期策略：
      1) 若當日時間尚未過，使用今天；2) 否則使用明天。
    - 保持每月未實作不變；每週路徑不受影響。

- A2.1-D 每日重複（變體表達）：FAIL
  - 與 A2.1-C 同因，為不同語句變體，亦落入追問日期路徑。
  - 建議修正：同 A2.1-C。

- A2.2-C 重複類型區分（daily/weekly/monthly）：FAIL（第 3 步每月）
  - 實際回覆：「僅支援每天與每週；每月後續提供」。
  - 判定失敗來自測試期望詞（包含每月/日期/時間）與「未支援提示」不一致。
  - 判定：屬規格預期的暫不支援行為，非功能錯誤；可將此用例標示為「預期失敗」或調整測試期望。

- A2.2-D 功能開關（每日關閉時降級）：FAIL
  - 實際回覆：追問「課程日期」。
  - 研判原因：關閉時的降級訊息未覆蓋每日用例，仍走缺槽追問。
  - 建議修正：若關閉重複功能且偵測到 daily/weekly 關鍵字，直接回覆「目前未開啟重複課程功能」的友善降級文案，避免進入追問流。

- A2.2-E 重複課時間衝突處理：FAIL
  - 實際回覆：追問「課程日期」。
  - 研判原因：第一步「每天」就被導向追問，未建立第一個事件，導致第二步也無法觸發衝突檢查。
  - 建議修正：待每日用例採用預設起始日期後，再驗證衝突檢查；P1 可僅檢查初次實例是否衝突。

### 差異觀察
- 本機 vs 線上差異集中在「每日重複」相關（本機 PASS、線上 FAIL）。
  - 線上目前仍有「缺日期→追問」行為，顯示預設起始日期策略尚未生效或路徑未覆蓋。
  - 每月用例依規格屬未支援，導致測試 FAIL 但非功能缺陷。

### 建議修復方案（最小變更）
1) 槽位與任務層支援每日重複的預設起始日期：
   - 缺日期時自動計算 `startDate`（今日未過→今日；已過→明日）。
2) 關閉開關時的降級訊息：
   - 若偵測到 daily/weekly 關鍵字且重複功能關閉，直接回覆統一文案，不進入追問。
3) 測試期望調整：
   - 「每月」用例暫標記為預期失敗（或將期望改為「未支援提示」）。

### 佐證片段（節選）
- A2.1-C：系統回覆「請提供以下資訊：課程日期」→ 顯示缺 `startDate` 預設。
- A2.2-C：系統回覆「僅支援每天與每週，每月後續提供」→ 屬預期限制，非錯誤。

### 資料來源
- `QA/reports/online-smoke-2025-08-13T07-44-57Z.md`
- `test-results/render-logs/trace-summary-2025-08-13T07-45-14-601Z.md`


