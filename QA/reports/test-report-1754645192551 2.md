# 統一 QA 測試報告

- **時間**: 2025-08-08T09:26:32.551Z
- **模式**: local
- **測試案例數**: 45

## 本機測試
- **總數**: 45
- **通過**: 24
- **失敗**: 21

## 詳細案例 - 本機
### 本機-1. 完整資訊輸入
- **輸入**: 測試小明明天下午2點要上測試數學課
- **結果**: ✅ PASS

### 本機-2. 時間格式多樣性
- **輸入**: 測試Lumi後天晚上八點半要上測試鋼琴課
- **結果**: ✅ PASS

### 本機-3. 中文數字時間
- **輸入**: 測試小光明天上午十點三十分測試英文課
- **結果**: ✅ PASS

### 本機-4. 缺少學生資訊
- **輸入**: 明天下午3點要上測試數學課
- **結果**: ❌ FAIL
- **輸出**: ✅ 課程已安排成功！  👦 學生：醒我測試小明 📚 課程：測試數學課 📅 日期：2025-08-09 🕐 時間：下午3:00
  - **失敗原因**: 測試案例之間未隔離對話上下文，系統從先前對話帶入/誤抽取了「醒我測試小明」作為學生，未按預期提示補齊缺少的學生資訊。
  - **歸類**: 測試系統問題（用例間上下文未重置，導致槽位被污染）。

### 本機-5. 缺少時間資訊
- **輸入**: 測試小明要上測試數學課
- **結果**: ✅ PASS

### 本機-6. 多輪對話完成流程
- **輸入**: 明天下午2點
- **結果**: ✅ PASS

### 本機-7. 無效時間格式
- **輸入**: 測試小明明天25點上測試數學課
- **結果**: ❌ FAIL
- **輸出**: ❌ 新增課程失敗，請檢查輸入資訊並稍後再試。
  - **失敗原因**: 系統以通用錯誤訊息處理無效時間，未回傳更精確的驗證錯誤（如 INVALID_TIME）。
  - **歸類**: 主系統問題（缺少細粒度的時間格式驗證與對應錯誤碼）。

### 本機-8. 過去時間輸入
- **輸入**: 測試小明昨天下午2點上測試數學課
- **結果**: ❌ FAIL
- **輸出**: ✅ 課程已安排成功！  👦 學生：測試小明 📚 課程：測試數學課 📅 日期：2025-08-07 🕐 時間：下午2:00
  - **失敗原因**: 允許建立過去日期的課程，與測試預期不符（應提示不可建立或要求修正）。
  - **歸類**: 主系統問題（缺少「不可建立過去時間」的商業規則校驗）。
  - **補充原因**: 學生姓名提取偶發受上下文污染（如殘留「提醒我」造成「醒我測試小明」），或規則未完全清除動作詞/助詞，導致姓名邊界不準確。
  - **補充歸類**: 測試系統問題（用例間上下文未重置）＋ 主系統問題（提取階段需更嚴格的動作詞/否定詞清洗）。

### 本機-9. 模糊語句處理
- **輸入**: 我想要什麼時候上課來著
- **結果**: ✅ PASS

### 本機-10. 每週重複課程
- **輸入**: 測試Lumi每週三下午3點要上測試鋼琴課
- **結果**: ✅ PASS

### 本機-11. 多天重複課程
- **輸入**: 測試小光每週一三五上午10點測試英文課
- **結果**: ✅ PASS

### 本機-12. 每天重複課程
- **輸入**: 測試小明每天早上8點測試晨練課
- **結果**: ✅ PASS

### 本機-13. 每日重複變體測試
- **輸入**: 安排測試Lumi每日下午5點測試瑜伽課
- **結果**: ✅ PASS

### 本機-14. 每月重複課程 
- **輸入**: 測試小光每月第一個週一上午10點測試評鑑
- **結果**: ✅ PASS

### 本機-15. 重複關鍵詞識別
- **輸入**: 安排測試小明定期游泳課每週二晚上7點
- **結果**: ✅ PASS

### 本機-16. 模糊重複表達
- **輸入**: 測試Lumi固定每個星期四下午兩點鋼琴課
- **結果**: ✅ PASS

### 本機-17. 重複類型區分測試
- **輸入**: 測試小明每月1號早上8點英文課
- **結果**: ✅ PASS

### 本機-18. 功能開關測試
- **輸入**: 
- **結果**: ❌ FAIL
- **輸出**: 😊 不太理解您的意思，試試這些功能：  • 新增課程：「小明明天上午10點英文課」 • 查詢課程：「查詢小明的課表」   • 記錄內容：「記錄昨天數學課的內容」 • 設定提醒：「設定提醒」  💡 您也可以直接告訴我想要做什麼，我會盡力幫助您！
  - **失敗原因**: 測試輸入為空，無法驗證「功能開關」的行為，屬無效測資。
  - **歸類**: 測試情境設計問題（案例不完整/無效）。

### 本機-19. 重複課程時間衝突處理
- **輸入**: 
- **結果**: ❌ FAIL
- **輸出**: 😊 不太理解您的意思，試試這些功能：  • 新增課程：「小明明天上午10點英文課」 • 查詢課程：「查詢小明的課表」   • 記錄內容：「記錄昨天數學課的內容」 • 設定提醒：「設定提醒」  💡 您也可以直接告訴我想要做什麼，我會盡力幫助您！
  - **失敗原因**: 測試輸入為空，無法觸發「衝突檢查」場景。
  - **歸類**: 測試情境設計問題（案例不完整/無效）。

### 本機-20. 意圖邊界測試
- **輸入**: 我想了解一下課程安排的情況
- **結果**: ❌ FAIL
- **輸出**: 📅 醒我測試小明本週的課程安排  📆 8/9 (週六)   下午2:00 - 十分測試英文課
  - **失敗原因**: 上下文污染導致槽位自動補全（來自 `mentionedEntities`/`pendingData`），將泛問句直接推導為「本週課表」並帶入殘留姓名（如「醒我測試小明」）；此案例本應先進行澄清提問而非直接輸出列表。
  - **歸類**: 測試系統問題（用例間上下文未重置）＋ 主系統問題（上下文增強策略過度激進；對泛問句應先澄清）。

### 本機-21. 複合意圖處理
- **輸入**: 幫我安排測試小明數學課，然後查詢一下他今天有什麼課
- **結果**: ❌ FAIL
- **輸出**: 📅 醒我測試小明今天沒有安排課程  💡 您可以： • 新增課程：「小明明天上午10點英文課」 • 查詢其他時間：「小明下週的課表」 • 記錄課程內容：「記錄昨天數學課的內容」
  - **失敗原因**: 同句包含「建立課程」與「查詢課表」兩個任務，系統尚未支援單輪複合任務流水處理。
  - **歸類**: 主系統問題（未支援複合意圖，需分步操作或後台分流）。

### 本機-22. 系統錯誤恢復
- **輸入**: 
- **結果**: ❌ FAIL
- **輸出**: 😊 不太理解您的意思，試試這些功能：  • 新增課程：「小明明天上午10點英文課」 • 查詢課程：「查詢小明的課表」   • 記錄內容：「記錄昨天數學課的內容」 • 設定提醒：「設定提醒」  💡 您也可以直接告訴我想要做什麼，我會盡力幫助您！
  - **失敗原因**: 測試輸入為空，無法驗證「錯誤恢復」具體流程。
  - **歸類**: 測試情境設計問題（案例不完整/無效）。

### 本機-23. 輸入修正流程
- **輸入**: 下午2點
- **結果**: ❌ FAIL
- **輸出**: 😊 不太理解您的意思，試試這些功能：  • 新增課程：「小明明天上午10點英文課」 • 查詢課程：「查詢小明的課表」   • 記錄內容：「記錄昨天數學課的內容」 • 設定提醒：「設定提醒」  💡 您也可以直接告訴我想要做什麼，我會盡力幫助您！
  - **失敗原因**: 此案例需在前一步已開啟的「期望輸入/修正流程」上下文中測試，單獨輸入時間無法觸發；目前用例未建立前置上下文。
  - **歸類**: 測試情境設計問題（缺少前置步驟/上下文）。

### 本機-24. 今日課程查詢
- **輸入**: 測試小明今天有什麼課？
- **結果**: ❌ FAIL
- **輸出**: 📅 測試小明今天沒有安排課程  💡 您可以： • 新增課程：「小明明天上午10點英文課」 • 查詢其他時間：「小明下週的課表」 • 記錄課程內容：「記錄昨天數學課的內容」
  - **失敗原因**: 測試假設存在預置課程資料；但當前 Phase A 策略為「僅清理、不預置」，因此自然回覆「沒有安排課程」。
  - **歸類**: 測試情境設計問題（對前置資料的假設與現行策略不一致）。

### 本機-25. 明天課程查詢
- **輸入**: 查詢測試Lumi明天的課表
- **結果**: ❌ FAIL
- **輸出**: 📅 測試Lumi明天沒有安排課程  💡 您可以： • 新增課程：「小明明天上午10點英文課」 • 查詢其他時間：「小明下週的課表」 • 記錄課程內容：「記錄昨天數學課的內容」
  - **失敗原因**: 同上，缺乏預置課程資料，系統回覆無課屬合理。
  - **歸類**: 測試情境設計問題（與資料策略不一致）。

### 本機-26. 本週課程查詢
- **輸入**: 看一下測試小光這週的安排
- **結果**: ✅ PASS

### 本機-27. 無課程日查詢
- **輸入**: 測試小王今天有什麼課？
- **結果**: ❌ FAIL
- **輸出**: 📅 測試小王今天沒有安排課程  💡 您可以： • 新增課程：「小明明天上午10點英文課」 • 查詢其他時間：「小明下週的課表」 • 記錄課程內容：「記錄昨天數學課的內容」
  - **失敗原因**: 實際輸出語義正確（無課），但判定依賴關鍵詞配置不當，導致誤判。
  - **歸類**: 測試系統問題（關鍵詞規則與預期不對齊，應改為結構化判定）。

### 本機-28. 特定課程查詢
- **輸入**: 測試小明的測試數學課什麼時候上？
- **結果**: ✅ PASS

### 本機-29. 每日重複課程查詢
- **輸入**: 測試小明的測試晨練課每天幾點？
- **結果**: ❌ FAIL
- **輸出**: ✅ 課程已安排成功！  👦 學生：測試小明 📚 課程：測試晨練課 🔄 重複：每天 上午7:00 📅 下次上課：2025-08-09
  - **失敗原因**: 該句為查詢，卻被誤判為「建立重複課程」，屬意圖分類/規則誤判。
  - **歸類**: 主系統問題（意圖辨識需區分查詢 vs 建立）。

### 本機-30. 重複課程類型識別查詢
- **輸入**: 查詢測試Lumi的重複課程
- **結果**: ❌ FAIL
- **輸出**: 📅 測試Lumi本週沒有安排課程  💡 您可以： • 新增課程：「小明明天上午10點英文課」 • 查詢其他時間：「小明下週的課表」 • 記錄課程內容：「記錄昨天數學課的內容」
  - **失敗原因**: 測試期望「辨識重複課程類型」，但當前系統不提供此類彙總查詢；且無預置資料。
  - **歸類**: 測試情境設計問題（超出現有功能範圍/依賴預置資料）。

### 本機-31. 當日課程記錄
- **輸入**: 今天測試小明的測試數學課學了分數加減法
- **結果**: ✅ PASS

### 本機-32. 昨日課程補記錄
- **輸入**: 補記一下昨天測試Lumi測試鋼琴課的內容，練習了小星星
- **結果**: ✅ PASS

### 本機-33. 查詢課程記錄
- **輸入**: 測試小明昨天測試數學課學了什麼？
- **結果**: ❌ FAIL
- **輸出**: ❌ 系統處理異常，請稍後再試
  - **失敗原因**: `query_course_content` 內排序時對 `createdAt` 非字串/空值處理不當，導致型別比較錯誤（localeCompare）。
  - **歸類**: 主系統問題（邏輯 bug，已在後續邏輯中增強健壯性）。

### 本機-34. 不存在課程記錄
- **輸入**: 記錄測試小明今天測試化學課的內容
- **結果**: ❌ FAIL
- **輸出**: ✅ 課程內容已成功記錄！ 📝 記錄為獨立內容 👨‍🎓 學生：測試小明 📚 課程：重複課 📅 日期：2025-08-08 💬 內容：測試小明今天測試化學課的內容
  - **失敗原因**: 產品設計允許「獨立內容記錄」（找不到對應課也可記錄），而測試假設必須綁定既有課程。
  - **歸類**: 測試情境設計問題（與產品規格不一致）。

### 本機-35. 標準課前提醒
- **輸入**: 提醒我測試小明的測試數學課
- **結果**: ✅ PASS

### 本機-36. 自訂提醒時間
- **輸入**: 測試Lumi測試鋼琴課前1小時提醒我
- **結果**: ❌ FAIL
- **輸出**: ❌ 找不到 醒我測試小明 的 測試鋼琴課，請確認課程是否已安排
  - **失敗原因**: 目標課程不存在（未預置或未先建立），提醒查找自然失敗。
  - **歸類**: 測試情境設計問題（需先建立課程或調整用例資料）。

### 本機-37. 不存在課程提醒
- **輸入**: 提醒我測試小明的測試物理課
- **結果**: ❌ FAIL
- **輸出**: ❌ 找不到 醒我測試小明 的 測試物理課，請確認課程是否已安排
  - **失敗原因**: 同上，目標課程不存在，提醒查找失敗屬合理行為。
  - **歸類**: 測試情境設計問題（需先建立課程或調整用例資料）。

### 本機-38. 修改課程時間
- **輸入**: 測試小明的測試數學課改到下午4點
- **結果**: ✅ PASS

### 本機-39. 修改每日重複課程時間
- **輸入**: 測試小明每天的測試晨練課改到早上7點
- **結果**: ❌ FAIL
- **輸出**: ✅ 課程已安排成功！  👦 學生：醒我測試小明 📚 課程：測試晨練課 🔄 重複：每天 上午7:00 📅 下次上課：2025-08-09
  - **失敗原因**: 系統將自然語「修改」誤走「新增重複課程」流程（目前修改主要透過 Quick Reply 引導），與用例期望不符。
  - **歸類**: 主系統問題（未完整支援自然語直接修改既有課程）。

### 本機-40. 修改重複課程類型
- **輸入**: 測試Lumi的測試鋼琴課改成每天下午3點
- **結果**: ✅ PASS

### 本機-41. 取消單次課程
- **輸入**: 取消測試小明明天的測試數學課
- **結果**: ✅ PASS

### 本機-42. 取消每日重複課程
- **輸入**: 取消測試小明的測試晨練課
- **結果**: ❌ FAIL
- **輸出**: ✅ 已取消 測試小明 的 測試晨練課 📅 原定時間：2025-08-09 07:00  💡 提示：已取消的課程仍保留在記錄中，可隨時查看歷史資料
  - **失敗原因**: 實際動作成功（code=COURSE_CANCEL_OK），但測試仍以關鍵詞期望判定，與真實成功訊息模板不一致而誤判。
  - **歸類**: 測試系統問題（應以結構化 `expected.code/expected.success` 判定）。

### 本機-43. 取消部分每日重複課程
- **輸入**: 取消測試小明下週的測試晨練課
- **結果**: ✅ PASS

### 本機-44. 重複課程類型區分取消
- **輸入**: 
- **結果**: ❌ FAIL
- **輸出**: 😊 不太理解您的意思，試試這些功能：  • 新增課程：「小明明天上午10點英文課」 • 查詢課程：「查詢小明的課表」   • 記錄內容：「記錄昨天數學課的內容」 • 設定提醒：「設定提醒」  💡 您也可以直接告訴我想要做什麼，我會盡力幫助您！
  - **失敗原因**: 測試輸入為空，無法驗證「區分取消」行為。
  - **歸類**: 測試情境設計問題（案例不完整/無效）。

### 本機-45. 併發用戶操作
- **輸入**: 
- **結果**: ✅ PASS
